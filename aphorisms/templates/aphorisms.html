{% extends "base.html" %}

{% block content %}

<script>
// Scripts for displaying aphorisms
// (Unfortunately Jinja won't read from an external js file)

	function display_article(contents) {
		// Display contents on the page
		HTMLString = "<div class=article>" + contents + "</div>";
		displaybox.innerHTML = HTMLString;
	}

	function show_flow() {
		// Display The Basic Flow of aphorisms
		aphos_in_flow = "";
		// For each aphorism
		{% for a in aphos["aphorisms"] %}
			// Add to display if "view" is "flow"
			// console.log("{{ a['view'] }}");
			{% if a["view"] == "flow" %}
				aphos_in_flow += "<div class=apho>" + 
						"{{ a.contents|safe }}" + 
					"</div>";
			{% endif %}
		{% endfor %}
		display_article(aphos_in_flow);
	}

	function get_one_set(setname) {
		// Return aphos that have setname as their set
		let aphos_in_set = "";
		{% for a in aphos["aphorisms"] %}
			if ("{{ a.set }}" == setname) {
				aphos_in_set += "<div class=apho>";
				aphos_in_set += "{{ a.contents|safe }}";
				aphos_in_set += "</div>";
			}
		{% endfor %}
		return aphos_in_set;
		}
		
	function show_one_set(setname) {
		set_to_show = "<div class=set_header>" + setname + "</div>";
		set_to_show += get_one_set(setname);
		display_article(set_to_show);
	}

	function get_list_of_sets() {
		// Return an array containing all the sets
		// Create a javascript set to remove duplicates
		let s = new(Set);
		{% for a in aphos["aphorisms"] %}
			s.add("{{ a.set }}");
		{% endfor %}
		// Convert to array in order to sort
		let list_of_sets = Array.from(s);
		list_of_sets.sort();
		return list_of_sets;
	}

	// Display the whole list of aphorisms
	function show_all_by_set() {
		let list_of_sets = get_list_of_sets();
		let aphos_all = "";
		for (let i=0; i<list_of_sets.length; i++) {
			let setname = list_of_sets[i];
			aphos_all += "<div class=set_header>" + setname + "</div>"
			aphos_all += get_one_set(setname);
		}
		display_article(aphos_all);
	}

</script>

<div class=bar_header>Aphorisms for the Neurodivergent</div>

<div class=article>
    <p><em>These are sayings I say to myself<br>
    in order to calm and center my consciousness<br>
    especially during episodes of withdrawl or anxiety.</em></p>
    <p></p>
</div>

<div class=bar_action>
	<button onclick="show_flow()">The Basic Flow</button> 
	<button onclick="show_one_set('feel')">One Set - Feel</button>
	<button onclick="show_all_by_set()">All by Set</button> 
	<button onclick="show_random_one()">Random One</button>
	<button onclick="show_random_all()">Random All</button>
</div>

<div id="displaybox">
	<p>no content</p>
	<script>show_flow();</script>
</div>

<div class=endnotes>
	<p>Notes</p>
    <p>Awareness, Acceptance, and Action
		are known as the "Three A's" in Twelve Step programs.</p>
	<p>"Bring It On," "I love pain," and "Pain sets me free 
		come from The Tools by Phil Stutz and Barry Michels.</p>
	<p>"Openness Gentleness Kindness"
		come from Pema Chodron, The Wisdom of No Escape.</p>
</div>


{% endblock %}
